# Система нумерации оборудования

## Описание

Система разделения номеров оборудования на два типа:
- **Инвентарный номер** - выдается бухгалтерией колледжа (только цифры)
- **Учётный номер** - выдается системой ICT (формат КодЗданияЭтаж-Группа-Номер)

## Структура номеров

### Инвентарный номер
- **Источник**: Бухгалтерия колледжа
- **Формат**: Только цифры (1-20 символов)
- **Примеры**: 123456789, 987654321, 555666777
- **Валидация**: `/^\d+$/`

### Учётный номер
- **Источник**: Система ICT
- **Формат**: КодЗданияЭтаж-Группа-Номер
- **Примеры**: А1-студент-001, Б3-преподаватель-005, А2-сотрудник-012, Б4-администрация-003
- **Валидация**: `/^[АБ][1-5]-(студент|преподаватель|администрация|сотрудник)-[0-9]{3}$/`

## Компоненты учётного номера

### Код здания
- **А** - корпус А
- **Б** - корпус Б

### Этаж
- **1, 2, 3, 4, 5** - номер этажа

### Группа пользователей
- **студент** - студенческое оборудование (может быть в корпусах А и Б)
- **преподаватель** - оборудование преподавателей
- **администрация** - административное оборудование
- **сотрудник** - оборудование сотрудников

### Номер оборудования
- **001, 002, 003...** - трехзначная последовательность

## База данных

### Миграция
```php
// Добавление поля учётного номера
Schema::table('equipment', function (Blueprint $table) {
    $table->string('accounting_number')->nullable()->after('inventory_number');
    $table->index('accounting_number');
});
```

### Модель Equipment
```php
protected $fillable = [
    "inventory_number",    // Инвентарный номер (бухгалтерия)
    "accounting_number",   // Учётный номер (система ICT)
    // ... другие поля
];
```

## Валидация

### Инвентарный номер
```php
'inventory_number' => 'required|string|min:1|max:20|unique:equipment,inventory_number|regex:/^\d+$/'
```

### Учётный номер
```php
'accounting_number' => [
    'nullable',
    'string',
    'min:3',
    'max:20',
    'unique:equipment,accounting_number',
    'regex:/^[АБ][1-5]-(студент|преподаватель|администрация|сотрудник)-[0-9]{3}$/'
]
```

## Пользовательский интерфейс

### Форма создания/редактирования
- **Инвентарный номер**: Обязательное поле, только цифры
- **Учётный номер**: Необязательное поле, с автодополнением
- **Счетчики символов**: Для обоих полей
- **Подсказки**: Формат и примеры для каждого типа

### Визуальное оформление
- **Инвентарный номер**: Синяя панель с информацией о бухгалтерии
- **Учётный номер**: Зеленая панель с форматом системы ICT

## Автодополнение

### Логика для учётного номера
1. **Ввод кода здания** (А/Б) → предложения этажей и групп
2. **Ввод этажа** (А1) → предложения групп
3. **Ввод группы** (А1-студент) → предложения номеров
4. **Завершение** → валидация формата

### Примеры автодополнения
| Ввод | Предложения |
|------|-------------|
| `а` | А1-студент-001, А1-администрация-001, А1-сотрудник-001... |
| `а1` | А1-студент-001, А1-администрация-001, А1-сотрудник-001 |
| `а1-` | А1-студент-001, А1-администрация-001, А1-сотрудник-001 |
| `а1-ст` | А1-студент-001 |

## Сообщения об ошибках

### Инвентарный номер
- `required` - "Пожалуйста, укажите инвентарный номер"
- `min` - "Инвентарный номер должен содержать не менее 1 символа"
- `max` - "Инвентарный номер не должен превышать 20 символов"
- `unique` - "Оборудование с таким инвентарным номером уже существует"
- `regex` - "Инвентарный номер должен содержать только цифры"

### Учётный номер
- `min` - "Учётный номер должен содержать не менее 3 символов"
- `max` - "Учётный номер не должен превышать 20 символов"
- `unique` - "Оборудование с таким учётным номером уже существует"
- `regex` - "Учётный номер должен соответствовать формату: КодЗданияЭтаж-Группа-Номер"

## Файлы системы

### Backend
- `database/migrations/2025_10_03_155639_add_accounting_number_to_equipment_table.php` - миграция
- `app/Models/Equipment.php` - модель
- `app/Http/Requests/StoreEquipmentRequest.php` - валидация создания
- `app/Http/Requests/UpdateEquipmentRequest.php` - валидация обновления

### Frontend
- `resources/views/equipment/create.blade.php` - форма создания
- `resources/views/equipment/edit.blade.php` - форма редактирования
- `resources/js/inventory-number-helper.js` - автодополнение учётного номера
- `resources/js/char-counter.js` - счетчики символов

### Документация
- `docs/equipment-numbering-system.md` - эта документация
- `docs/inventory-number-system.md` - старая документация (устарела)
- `docs/char-counter-component.md` - документация счетчика

## Миграция данных

При запуске миграции:
1. Добавляется поле `accounting_number` в таблицу `equipment`
2. Создается индекс для быстрого поиска
3. Существующие данные остаются без изменений
4. Новые записи могут иметь оба номера

## Использование

### Создание оборудования
1. **Обязательно**: Указать инвентарный номер (цифры)
2. **Опционально**: Указать учётный номер (с автодополнением)
3. **Валидация**: Проверка уникальности обоих номеров

### Поиск оборудования
- По инвентарному номеру (бухгалтерия)
- По учётному номеру (система ICT)
- По любому из номеров

### Отчетность
- Разделение по источникам номеров
- Анализ покрытия учётными номерами
- Сопоставление с бухгалтерскими данными
